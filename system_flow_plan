
# ESG 教學式問答系統 System Flow Plan v1.0（完整版）

本系統為一套模組化、可擴充的教學型問答架構，專為 ESG 與溫室氣體盤查教育設計，支援題庫套用、AI 協作、回饋產出與報告整合。此框架設計重點在於：模組功能明確、流程結構穩定、資料格式標準、未來可多主題延伸。

---

## 一、使用者流程（User Flow）

1. **登入畫面**
   - 輸入：姓名、公司名稱、Email、產業別（六選一）
   - 儲存使用者初始資訊，後續報告引用

2. **系統引導**
   - 顯示使用說明：操作流程、AI 功能、作答方式
   - 引導進入測試題（非正式題組）

3. **測試題（5 題）**
   - 教學導向題目，解釋基本 ESG 與溫室氣體概念
   - 不列入正式問答流程與報告分析

---

## 二、主體階段邏輯

### 初階階段（共 25 題）
- 固定題目順序，不能跳題，不能回頭修改（首次作答）
- 題目皆可選擇選項（含說明）或自由輸入回答
- AI 可根據回答給予補充解釋與延伸提問
- 左側進度顯示目前章節與進度（非可點選）
- 完成後選擇：
  - 直接產出初階報告（約 500 字）
  - 或進入進階階段（需 40–60 分鐘）

### 進階階段（約 30–35 題）
- 題目數視產業而定
- 更聚焦於實務經驗、盤查制度、策略設計等
- 題目順序固定、不可跳題
- 回答後不可修改，但可回顧已完成內容
- 完成後產出進階報告（約 1000 字）

---

## 三、題庫設計原則

- 每個產業一份獨立 CSV 題庫
- 命名規則：`questions_<industry>.csv`
- 基本結構欄位：
  - `id`：題號
  - `section`：章節分類
  - `text`：題目內容
  - `options`：選項（含說明）
  - `followups`：延伸提問（提供 AI 提示用）
  - `level`：初階 or 進階
  - `industry_tag`：對應產業

---

## 四、報告產出

### 初階報告
- 條件：完成 25 題即可產出
- 內容：約 500 字，摘要重點回饋與提醒
- 呈現：網頁區塊顯示，不提供下載

### 進階報告
- 條件：完成全部進階題組
- 內容：約 1000 字，分段式診斷與建議
- 呈現：網頁顯示，日後可接 GPT-4o 優化生成 PDF/Markdown

---

## 五、反覆填答機制

- 使用者第二次登入可選擇「重新作答」
- 系統保留歷史版本（V1、V2...）
- 報告可對照版本差異
- 進階使用者可從頭體驗，或只重作部分章節

---

## 六、前端互動限制與建議設計

- 問題與選項欄固定於上方
- AI 回覆使用對話泡泡形式展現
- 可選擇顯示延伸提示或不顯示
- 左側進度條可縮放收合，僅作章節指示用途
- 禁止自由跳題（除非進入「練習模式」）

---

## 七、模組對應功能（與 `module_plan.txt` 對應）

| 模組名稱 | 功能簡述 |
|----------|----------|
| question_loader.py | 載入並解析題庫 CSV |
| flow_controller.py | 控制題目流程與階段切換 |
| answer_saver.py | 儲存每題作答與修正紀錄 |
| followup_engine.py | 管理延伸提問與合法自由提問範圍 |
| response_engine.py | 呼叫 GPT 回應並組合教學型內容 |
| report_generator.py | 根據作答內容生成摘要報告 |
| ui_state_manager.py | 控制前端區塊顯示與互動狀態 |
| topic_manager.py | 管理題庫切換與產業配置 |

---

## 八、可擴充方向

- 新增題庫僅需上傳對應產業的 CSV 檔
- 題庫版本控管可另設 metadata 檔紀錄
- 報告模組日後可接 GPT-4o 建立多版本對照式摘要
- 將來支援 MCP 結構時，可自動串接外部工具與語意模組

---

【版本】system_flow_plan_v1.0_full
【建立者】使用者 x ChatGPT 協作設計
