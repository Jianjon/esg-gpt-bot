# ðŸ§  ESG é¡§å•äº’å‹•ç³»çµ±æµç¨‹è¦åŠƒï¼ˆSystem Flow Planï¼‰

æœ¬æ–‡ä»¶æè¿° ESG GPT é¡§å•ç³»çµ±çš„æ•´é«”é‚è¼¯æµç¨‹ã€ä½œç­”éšŽæ®µã€ç³»çµ±è¨˜æ†¶èˆ‡è³‡æ–™å»ºç½®æ–¹å¼ã€‚

---

## ä¸€ã€ä½¿ç”¨è€…äº’å‹•æµç¨‹æ¦‚è¿°

1. ä½¿ç”¨è€…è¼¸å…¥å§“åèˆ‡é¸æ“‡ç”¢æ¥­
2. é€²å…¥æ•™å­¸å°Žå‘æ¸¬è©¦é¡Œï¼ˆ5 é¡Œï¼‰
3. é€²å…¥åˆéšŽå•é¡Œï¼ˆ25 é¡Œï¼‰
4. å®ŒæˆåˆéšŽå¾Œå¯é¸æ“‡é€²éšŽé¡Œï¼ˆ30-35 é¡Œï¼‰
5. æ¯é¡Œç‚ºå–®é¸/è¤‡é¸é¸é … + é¡§å•å¼•å°Žå¼å•æ³•
6. æœ€å¾Œå¯ç”Ÿæˆæ‘˜è¦å ±å‘Šï¼ˆåˆéšŽï¼š500 å­— / é€²éšŽï¼š1000 å­—ï¼‰
7. æ‰€æœ‰å°è©±èˆ‡ä½œç­”çš†å¯è¨˜éŒ„ä¸¦å›žé¡§

---

## äºŒã€å•å·è¨­è¨ˆåŽŸå‰‡

- é¡Œç›®ä¾ç”¢æ¥­å®¢è£½åŒ–
- é¡Œåº«å„²å­˜åœ¨ `/data/*.csv` ä¸­
- é¡Œç›®é¡žåž‹ç‚º single / multipleï¼Œä¸è€ƒæ…®æ­£ç¢ºç­”æ¡ˆ
- é¡Œåº«æ¬„ä½å›ºå®šï¼š`id, stage, topic, text, options, type, hint`
- åˆéšŽèˆ‡é€²éšŽé¡Œç›®åˆ†é–‹ï¼Œä¸å¯è‡ªç”±è·³é¡Œ
- é¡Œè™Ÿè¨­è¨ˆï¼šæ•™å­¸å°Žå‘ç‚º `S000â€“S004`ï¼Œå…¶é¤˜ç‚ºç”¢æ¥­åˆ¥ç·¨è™Ÿ

---

## ä¸‰ã€ä½œç­”æµç¨‹æŽ§åˆ¶ï¼ˆAnswerSessionï¼‰

- æ¯ä½ä½¿ç”¨è€…é€²å…¥å•å·å¾Œå»ºç«‹ `AnswerSession`
- å¯é€é¡Œè¨˜éŒ„å›žç­”
- ä½¿ç”¨ `get_current_question()` æŽ§åˆ¶æµç¨‹
- è‹¥å…¨éƒ¨ä½œç­”å®Œç•¢ï¼Œè‡ªå‹•é¡¯ç¤ºå®Œæˆç•«é¢èˆ‡æ‘˜è¦

---

## å››ã€é¡§å•æ¨¡å¼ï¼ˆconsult_chat_app.pyï¼‰

- æ¯ä¸€é¡Œè½‰ç‚ºé¡§å•å¼èªžå¥ï¼Œç”± GPT-4o ç”Ÿæˆè‡ªç„¶æå•
- ä½¿ç”¨è€…è¼¸å…¥å›žæ‡‰å¾Œï¼š
  - è¨˜éŒ„ä½œç­”
  - å‘¼å« `context_tracker.py` å„²å­˜è©²é¡Œæ‘˜è¦
- é¡¯ç¤ºæ­·å²å°è©±ï¼š`st.chat_message(...)`
- æ‰€æœ‰å…§å®¹å„²å­˜åœ¨ `st.session_state.chat_history`ã€`consult_session` ä¸­

---

## äº”ã€å ±å‘Šç”Ÿæˆèˆ‡å‘é‡æŸ¥è©¢ï¼ˆæœªä¾†æ“´å……ï¼‰

- å ±å‘Šç”Ÿæˆå°‡æ•´åˆæ‰€æœ‰ä½œç­”èˆ‡æ‘˜è¦
- æ”¯æ´å‘¼å«å‘é‡åº«ï¼ˆRAGï¼‰è£œå……å»ºè­°æ–‡å­—
- ç”¢æ¥­åˆ¥å¯å°æ‡‰ baseline å»ºè­°å€¼
- è‹¥æœ‰å®Œæ•´å›žæ‡‰ç´€éŒ„ï¼Œä¹Ÿå¯çµåˆåœ–è¡¨å‘ˆç¾

---

## å…­ã€ä½¿ç”¨è€…ç‹€æ…‹èˆ‡è¨˜æ†¶æ©Ÿåˆ¶

- æ‰€æœ‰ç‹€æ…‹çš†ä½¿ç”¨ `st.session_state` ç®¡ç†ï¼š

| æ¬„ä½åç¨±             | èªªæ˜Ž                                   |
|----------------------|----------------------------------------|
| `user_name`          | ä½¿ç”¨è€…åç¨±                             |
| `industry`           | æ‰€é¸ç”¢æ¥­ï¼ˆå¦‚ restaurant, logisticsï¼‰    |
| `stage`              | å•å·éšŽæ®µï¼ˆbasic / advancedï¼‰           |
| `consult_session`    | å•å·ä½œç­”æŽ§åˆ¶æ¨¡çµ„                       |
| `chat_history`       | é¡§å•æ¨¡å¼ä¸‹çš„å°è©±ç´€éŒ„                   |
| `vector_store`       | FAISS å‘é‡åº«è¼‰å…¥ç‰©ä»¶ï¼ˆç”± fallback ç®¡ç†ï¼‰|

- è¨­è¨ˆåŽŸå‰‡ï¼š
  - ç¼ºå°‘ä»»ä¸€ç‹€æ…‹æœƒåœæ­¢æµç¨‹
  - å¯å»¶ä¼¸åŠ å…¥ `start_time`ã€`finish_time` ä¾›çµ±è¨ˆä½¿ç”¨

---

## ä¸ƒã€å‘é‡æŸ¥è©¢æµç¨‹åœ–ï¼ˆRAGï¼‰

```mermaid
flowchart TD
    A[ä½¿ç”¨è€…è¼¸å…¥å•é¡Œ] --> B[æŸ¥æ‰¾å‘é‡è³‡æ–™åº«ï¼ˆFAISSï¼‰]
    B --> C[æ‰¾å‡ºæœ€ç›¸è¿‘æ®µè½ï¼ˆTop-kï¼‰]
    C --> D[çµ„åˆæˆ Prompt æä¾›èƒŒæ™¯çŸ¥è­˜]
    D --> E[å‚³é€è‡³ GPT-4o æ¨¡åž‹]
    E --> F[è¼¸å‡ºè‡ªç„¶èªžè¨€å›žç­”]

